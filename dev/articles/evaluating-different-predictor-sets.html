<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Evaluating different predictor sets • workflowsets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating different predictor sets">
<meta name="robots" content="noindex">
<script defer data-domain="workflowsets.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">workflowsets</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/evaluating-different-predictor-sets.html">Evaluating different predictor sets</a></li>
    <li><a class="dropdown-item" href="../articles/tuning-and-comparing-models.html">Tuning and comparing models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/workflowsets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Evaluating different predictor sets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/workflowsets/blob/main/vignettes/evaluating-different-predictor-sets.Rmd" class="external-link"><code>vignettes/evaluating-different-predictor-sets.Rmd</code></a></small>
      <div class="d-none name"><code>evaluating-different-predictor-sets.Rmd</code></div>
    </div>

    
    
<p>Workflow sets are collections of tidymodels workflow objects that are
created as a set. A workflow object is a combination of a preprocessor
(e.g. a formula or recipe) and a <code>parsnip</code> model
specification.</p>
<p>For some problems, users might want to try different combinations of
preprocessing options, models, and/or predictor sets. In stead of
creating a large number of individual objects, a cohort of workflows can
be created simultaneously.</p>
<p>In this example, we’ll fit the same model but specify different
predictor sets in the preprocessor list.</p>
<p>Let’s take a look at the customer churn data from the
<code>modeldata</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mlc_churn</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mlc_churn</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 20</span></span></code></pre></div>
<p>There are 19 predictors, mostly numeric. This include aspects of
their account, such as <code>number_customer_service_calls</code>. The
outcome is a factor with two levels: “yes” and “no”.</p>
<p>We’ll use a logistic regression to model the data. Since the data set
is not small, we’ll use basic 10-fold cross-validation to get resampled
performance estimates.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/workflowsets" class="external-link">workflowsets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/parsnip" class="external-link">parsnip</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsample.tidymodels.org" class="external-link">rsample</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">lr_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://parsnip.tidymodels.org/reference/logistic_reg.html" class="external-link">logistic_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">trn_tst_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">initial_split</a></span><span class="op">(</span><span class="va">mlc_churn</span>, strata <span class="op">=</span> <span class="va">churn</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Resample the training set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/vfold_cv.html" class="external-link">vfold_cv</a></span><span class="op">(</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">training</a></span><span class="op">(</span><span class="va">trn_tst_split</span><span class="op">)</span>, strata <span class="op">=</span> <span class="va">churn</span><span class="op">)</span></span></code></pre></div>
<p>We would make a basic workflow that uses this model specification and
a basic formula. However, in this application, we’d like to know which
predictors are associated with the best area under the ROC curve.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/leave_var_out_formulas.html">leave_var_out_formulas</a></span><span class="op">(</span><span class="va">churn</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mlc_churn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">formulas</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span></span>
<span><span class="va">formulas</span><span class="op">[[</span><span class="st">"area_code"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; churn ~ state + account_length + international_plan + voice_mail_plan + </span></span>
<span><span class="co">#&gt;     number_vmail_messages + total_day_minutes + total_day_calls + </span></span>
<span><span class="co">#&gt;     total_day_charge + total_eve_minutes + total_eve_calls + </span></span>
<span><span class="co">#&gt;     total_eve_charge + total_night_minutes + total_night_calls + </span></span>
<span><span class="co">#&gt;     total_night_charge + total_intl_minutes + total_intl_calls + </span></span>
<span><span class="co">#&gt;     total_intl_charge + number_customer_service_calls</span></span>
<span><span class="co">#&gt; &lt;environment: base&gt;</span></span></code></pre></div>
<p>We create our workflow set:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">churn_workflows</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/workflow_set.html">workflow_set</a></span><span class="op">(</span></span>
<span>    preproc <span class="op">=</span> <span class="va">formulas</span>,</span>
<span>    models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>logistic <span class="op">=</span> <span class="va">lr_model</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">churn_workflows</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A workflow set/tibble: 20 × 4</span></span></span>
<span><span class="co">#&gt;    wflow_id                               info     option    result    </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> state_logistic                         <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> account_length_logistic                <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> area_code_logistic                     <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> international_plan_logistic            <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> voice_mail_plan_logistic               <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> number_vmail_messages_logistic         <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> total_day_minutes_logistic             <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> total_day_calls_logistic               <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> total_day_charge_logistic              <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> total_eve_minutes_logistic             <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> total_eve_calls_logistic               <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> total_eve_charge_logistic              <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> total_night_minutes_logistic           <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> total_night_calls_logistic             <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> total_night_charge_logistic            <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> total_intl_minutes_logistic            <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> total_intl_calls_logistic              <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> total_intl_charge_logistic             <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> number_customer_service_calls_logistic <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> everything_logistic                    <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[0]&gt;</span> <span style="color: #949494;">&lt;list [0]&gt;</span></span></span></code></pre></div>
<p>Since we are using basic logistic regression, there is nothing to
tune for these models. Instead of <code><a href="https://tune.tidymodels.org/reference/tune_grid.html" class="external-link">tune_grid()</a></code>, we’ll use
<code><a href="https://tune.tidymodels.org/reference/fit_resamples.html" class="external-link">tune::fit_resamples()</a></code> instead by giving that function name
as the first argument:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">churn_workflows</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">churn_workflows</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/workflow_map.html">workflow_map</a></span><span class="op">(</span><span class="st">"fit_resamples"</span>, resamples <span class="op">=</span> <span class="va">folds</span><span class="op">)</span></span>
<span><span class="va">churn_workflows</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A workflow set/tibble: 20 × 4</span></span></span>
<span><span class="co">#&gt;    wflow_id                               info     option    result   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> state_logistic                         <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> account_length_logistic                <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> area_code_logistic                     <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> international_plan_logistic            <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> voice_mail_plan_logistic               <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> number_vmail_messages_logistic         <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> total_day_minutes_logistic             <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> total_day_calls_logistic               <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> total_day_charge_logistic              <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> total_eve_minutes_logistic             <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> total_eve_calls_logistic               <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> total_eve_charge_logistic              <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> total_night_minutes_logistic           <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> total_night_calls_logistic             <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> total_night_charge_logistic            <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> total_intl_minutes_logistic            <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> total_intl_calls_logistic              <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> total_intl_charge_logistic             <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> number_customer_service_calls_logistic <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> everything_logistic                    <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;opts[1]&gt;</span> <span style="color: #949494;">&lt;rsmp[+]&gt;</span></span></span></code></pre></div>
<p>To assess how to measure the effect of each predictor, let’s subtract
the area under the ROC curve for each predictor from the same metric
from the full model. We’ll match first by resampling ID, the compute the
mean difference.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roc_values</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">churn_workflows</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tune.tidymodels.org/reference/collect_predictions.html" class="external-link">collect_metrics</a></span><span class="op">(</span>summarize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.metric</span> <span class="op">==</span> <span class="st">"roc_auc"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>wflow_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_logistic"</span>, <span class="st">""</span>, <span class="va">wflow_id</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">roc_values</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">wflow_id</span> <span class="op">==</span> <span class="st">"everything"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">.estimate</span>, <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">differences</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">roc_values</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">wflow_id</span> <span class="op">!=</span> <span class="st">"everything"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">full_model</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>performance_drop <span class="op">=</span> <span class="va">full_model</span> <span class="op">-</span> <span class="va">.estimate</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_stats</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">differences</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">wflow_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    std_err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">performance_drop</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">performance_drop</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    performance_drop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">performance_drop</span><span class="op">)</span>,</span>
<span>    lower <span class="op">=</span> <span class="va">performance_drop</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">std_err</span>,</span>
<span>    upper <span class="op">=</span> <span class="va">performance_drop</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">std_err</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    wflow_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">wflow_id</span><span class="op">)</span>,</span>
<span>    wflow_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">wflow_id</span>, <span class="va">performance_drop</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">summary_stats</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">lower</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 5</span></span></span>
<span><span class="co">#&gt;   wflow_id                     std_err performance_drop   lower   upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> account_length               1.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>          0.001<span style="text-decoration: underline;">32</span> 9.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.001<span style="text-decoration: underline;">65</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> international_plan           1.56<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>          0.058<span style="text-decoration: underline;">5</span>  5.55<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 0.061<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> number_customer_service_cal… 2.86<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>          0.065<span style="text-decoration: underline;">3</span>  5.97<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 0.070<span style="text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> number_vmail_messages        3.36<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>          0.001<span style="text-decoration: underline;">77</span> 1.11<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0.002<span style="text-decoration: underline;">43</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> voice_mail_plan              6.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>          0.003<span style="text-decoration: underline;">79</span> 2.58<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 0.004<span style="text-decoration: underline;">99</span></span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">summary_stats</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">performance_drop</span>, y <span class="op">=</span> <span class="va">wflow_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">lower</span>, xmax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="evaluating-different-predictor-sets_files/figure-html/churn-metrics-1.png" width="576"></p>
<p>From this, there are a predictors that, when not included in the
model, have a significant effect on the performance metric.</p>
  </main>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, Simon Couch, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
